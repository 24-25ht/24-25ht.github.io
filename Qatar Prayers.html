<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qatar Prayer Times | صلاة</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --primary: #0d4a3a;
            --primary-light: #1a6b54;
            --gold: #d4af37;
            --gold-light: #f4d03f;
            --cream: #faf8f5;
            --dark: #1a1a2e;
            --card-bg: rgba(255, 255, 255, 0.95);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--dark) 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            color: white;
        }

        .mosque-icon {
            font-size: 3rem;
            color: var(--gold);
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .header h1 {
            font-family: 'Amiri', serif;
            font-size: 2.5rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .arabic-title {
            font-family: 'Amiri', serif;
            font-size: 1.8rem;
            color: var(--gold);
            margin-bottom: 10px;
        }

        .ornament {
            color: var(--gold);
            font-size: 1.5rem;
            letter-spacing: 10px;
        }

        /* Date Cards */
        .date-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .date-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .date-card i {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .date-card .label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .date-card .value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        /* Next Prayer */
        .next-prayer-card {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.4);
            position: relative;
            overflow: hidden;
        }

        .next-prayer-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 60%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .next-prayer-card .time {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--dark);
            position: relative;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .next-prayer-card .label {
            font-size: 1rem;
            color: var(--dark);
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .next-prayer-card .prayer-name {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
            position: relative;
        }

        .next-prayer-card .countdown {
            font-size: 1rem;
            color: var(--dark);
            opacity: 0.9;
            margin-top: 10px;
            position: relative;
        }

        /* Verse */
        .verse-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-left: 4px solid var(--gold);
        }

        .verse-card i {
            color: var(--gold);
            font-size: 1.2rem;
        }

        .verse-card p {
            font-family: 'Amiri', serif;
            font-size: 1.1rem;
            color: #444;
            line-height: 1.8;
            margin: 15px 0;
            font-style: italic;
        }

        .verse-card .reference {
            color: var(--primary);
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Prayer Times Grid - UPDATED FOR 8 BOXES IN 2x4 LAYOUT */
        .prayer-section h2 {
            text-align: center;
            color: white;
            font-family: 'Amiri', serif;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .prayer-section h2 i {
            color: var(--gold);
            margin: 0 10px;
        }

        .prayer-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .prayer-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid transparent;
            position: relative;
            height: 230px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .prayer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .prayer-card.active {
            border-color: var(--gold);
            background: linear-gradient(135deg, #fff 0%, #fffef5 100%);
        }

        .prayer-card.active::after {
            content: 'NEXT';
            position: absolute;
            top: -8px;
            right: 10px;
            background: var(--gold);
            color: var(--dark);
            font-size: 0.65rem;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .prayer-card .icon {
            font-size: 2.2rem;
            margin-bottom: 12px;
        }

        .prayer-card.fajr .icon { color: #5c6bc0; }
        .prayer-card.sunrise .icon { color: #ff9800; }
        .prayer-card.dhuhr .icon { color: #ffc107; }
        .prayer-card.asr .icon { color: #ff7043; }
        .prayer-card.sunset .icon { color: #ff6b35; }
        .prayer-card.maghrib .icon { color: #ef5350; }
        .prayer-card.isha .icon { color: #3f51b5; }
        .prayer-card.midnight .icon { color: #4527a0; }

        .prayer-card .name {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 1.05rem;
        }

        .prayer-card .arabic {
            font-family: 'Amiri', serif;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .prayer-card .time {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--dark);
        }
        .prayer-card .iqama {
            font-size: 0.85rem;
            color: #666;
            margin-top: 8px;
            font-weight: 600;
        }

        /* Location Adjustments */
        .adjustments-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .adjustments-section h3 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .adjustments-section h3 i {
            color: var(--gold);
        }

        .locations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .location-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .location-item i.fa-location-dot {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .location-item .name {
            font-weight: 500;
            flex: 1;
        }

        .location-item .adjustments {
            display: flex;
            gap: 8px;
            font-size: 0.8rem;
        }

        .location-item .adj {
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: 500;
        }

        .location-item .adj.sun {
            background: #fff3e0;
            color: #e65100;
        }

        .location-item .adj.moon {
            background: #e8eaf6;
            color: #3f51b5;
        }

        /* Quick Links */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .quick-link {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            text-decoration: none;
            color: var(--primary);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .quick-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .quick-link i {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--gold);
        }

        .quick-link span {
            display: block;
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: rgba(255,255,255,0.7);
            font-size: 0.85rem;
        }

        .footer .brand {
            font-family: 'Amiri', serif;
            font-size: 1.3rem;
            color: var(--gold);
            margin-bottom: 10px;
        }

        .footer .brand i {
            margin-right: 8px;
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .prayer-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .prayer-card {
                height: 200px;
            }
        }

        @media (max-width: 900px) {
            .prayer-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .prayer-card {
                height: 180px;
            }
            
            .quick-links {
                grid-template-columns: 1fr;
            }
            
            .locations-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header .arabic-title {
                font-size: 1.4rem;
            }
            
            .date-section {
                grid-template-columns: 1fr;
            }
            
            .next-prayer-card .time {
                font-size: 2.5rem;
            }
            
            .prayer-grid {
                grid-template-columns: 1fr;
            }
            
            .prayer-card {
                height: auto;
                padding: 16px;
            }
            
            .quick-links {
                grid-template-columns: 1fr;
            }
            
            .locations-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (min-width: 1600px) {
            .prayer-card {
                height: 240px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="mosque-icon">
                <i class="fas fa-mosque"></i>
            </div>
            <h1>Qatar Prayer Times</h1>
            <div class="arabic-title">أوقات الصلاة في قطر</div>
            <div class="ornament">◆ <i class="fas fa-star-and-crescent"></i> ◆</div>
        </header>

        <!-- Date Section -->
        <div class="date-section">
            <div class="date-card">
                <i class="fas fa-moon"></i>
                <div class="label">Hijri Date</div>
                <div class="value" id="hijri-date">Loading...</div>
            </div>
            <div class="date-card">
                <i class="fas fa-calendar-alt"></i>
                <div class="label">Gregorian Date</div>
                <div class="value" id="gregorian-date">Loading...</div>
            </div>
        </div>

        <!-- Next Prayer -->
        <div class="next-prayer-card">
            <div class="label">Next Prayer</div>
            <div class="time" id="current-time">--:--:--</div>
            <div class="prayer-name" id="next-prayer-name">--</div>
            <div class="countdown" id="countdown">--</div>
        </div>

        <!-- Verse -->
        <div class="verse-card">
            <i class="fas fa-quote-left"></i>
            <p>"Indeed, prayer has been decreed upon the believers a decree of specified times."</p>
            <div class="reference">— Surah An-Nisa 4:103</div>
        </div>

        <!-- Prayer Times -->
        <section class="prayer-section">
            <h2><i class="fas fa-star"></i> Prayer Times <i class="fas fa-star"></i></h2>
            <div class="prayer-grid" id="prayer-grid">
                <!-- 8 Prayer cards will be inserted here -->
            </div>
        </section>

        <!-- Location Adjustments -->
        <div class="adjustments-section">
            <h3><i class="fas fa-sliders"></i> Location Adjustments</h3>
            <div class="locations-grid">
                <div class="location-item">
                    <i class="fas fa-location-dot"></i>
                    <span class="name">Abu Samra</span>
                    <div class="adjustments">
                        <span class="adj sun"><i class="fas fa-sun"></i> +4</span>
                        <span class="adj moon"><i class="fas fa-moon"></i> +2</span>
                    </div>
                </div>
                <div class="location-item">
                    <i class="fas fa-location-dot"></i>
                    <span class="name">Doha</span>
                    <div class="adjustments">
                        <span class="adj sun"><i class="fas fa-sun"></i> 0</span>
                        <span class="adj moon"><i class="fas fa-moon"></i> 0</span>
                    </div>
                </div>
                <div class="location-item">
                    <i class="fas fa-location-dot"></i>
                    <span class="name">Dukhan</span>
                    <div class="adjustments">
                        <span class="adj sun"><i class="fas fa-sun"></i> +5</span>
                        <span class="adj moon"><i class="fas fa-moon"></i> +1</span>
                    </div>
                </div>
                <div class="location-item">
                    <i class="fas fa-location-dot"></i>
                    <span class="name">Al Shamal</span>
                    <div class="adjustments">
                        <span class="adj sun"><i class="fas fa-sun"></i> +3</span>
                        <span class="adj moon"><i class="fas fa-moon"></i> -2</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Links -->
        <div class="quick-links">
            <a href="https://www.islam.gov.qa/e-services/search-mosques" class="quick-link">
                <i class="fas fa-mosque"></i>
                <span>Find Nearby Mosques</span>
            </a>
            <a href="#" class="quick-link">
                <i class="fas fa-compass"></i>
                <span>Qibla Direction</span>
            </a>
            <a href="https://24-25ht.github.io/Quran.html" class="quick-link">
                <i class="fas fa-book-open"></i>
                <span>Daily Adhkar</span>
            </a>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="brand">
                <i class="fas fa-star-and-crescent"></i>
                Qatar Prayer Times
            </div>
            <p>Times are calculated for Doha, Qatar using Al Adhan API (Method 10 - Qatar)</p>
            <p>Version 3.0 • Made By Abdullah Karim • Made with <i class="fas fa-heart" style="color: #e74c3c;"></i></p>
        </footer>
    </div>

    <script>
        const prayers = [
            { id: 'fajr', name: 'Fajr', arabic: 'الفجر', icon: 'fa-cloud-moon', key: 'Fajr' },
            { id: 'sunrise', name: 'Sunrise', arabic: 'الشروق', icon: 'fa-sun', key: 'Sunrise' },
            { id: 'dhuhr', name: 'Dhuhr', arabic: 'الظهر', icon: 'fa-sun', key: 'Dhuhr' },
            { id: 'asr', name: 'Asr', arabic: 'العصر', icon: 'fa-cloud-sun', key: 'Asr' },
            { id: 'sunset', name: 'Sunset', arabic: 'الغروب', icon: 'fa-sun', key: 'Sunset' },
            { id: 'maghrib', name: 'Maghrib', arabic: 'المغرب', icon: 'fa-circle-half-stroke', key: 'Maghrib' },
            { id: 'isha', name: 'Isha', arabic: 'العشاء', icon: 'fa-moon', key: 'Isha' },
            { id: 'midnight', name: 'Midnight', arabic: 'منتصف الليل', icon: 'fa-star', key: 'Midnight' }
        ];

        const iconMap = {
            'fajr': 'fa-cloud-moon',
            'sunrise': 'fa-sun',
            'dhuhr': 'fa-sun',
            'asr': 'fa-cloud-sun',
            'sunset': 'fa-circle-notch',
            'maghrib': 'fa-circle-half-stroke',
            'isha': 'fa-moon',
            'midnight': 'fa-star'
        };

        let prayerTimes = {};
        const iqamaOffsets = {
            'Fajr': 25,
            'Sunrise': 0,
            'Dhuhr': 20,
            'Asr': 25,
            'Sunset': 0,
            'Maghrib': 10,
            'Isha': 20,
            'Midnight': 0
        };

        function calculateIqama(timeStr, offsetMinutes) {
            const match = timeStr.match(/(\d+):(\d+)\s*(AM|PM)?/i);
            if (!match) return timeStr;

            let hours = parseInt(match[1], 10);
            const minutes = parseInt(match[2], 10);
            const period = match[3] ? match[3].toUpperCase() : null;

            if (period) {
                if (period === 'PM' && hours !== 12) hours += 12;
                if (period === 'AM' && hours === 12) hours = 0;
            }

            let totalMinutes = hours * 60 + minutes + offsetMinutes;
            let newHours = Math.floor(totalMinutes / 60) % 24;
            const newMinutes = totalMinutes % 60;

            const newPeriod = newHours >= 12 ? 'PM' : 'AM';
            if (newHours > 12) newHours -= 12;
            if (newHours === 0) newHours = 12;

            return `${newHours}:${String(newMinutes).padStart(2, '0')} ${newPeriod}`;
        }

        function timeToMinutes(timeStr) {
            const match = timeStr.match(/(\d+):(\d+)\s*(AM|PM)?/i);
            if (!match) return 0;

            let hours = parseInt(match[1], 10);
            const minutes = parseInt(match[2], 10);
            const period = match[3] ? match[3].toUpperCase() : null;

            if (period) {
                if (period === 'PM' && hours !== 12) hours += 12;
                if (period === 'AM' && hours === 12) hours = 0;
            }

            return hours * 60 + minutes;
        }

        // Convert a HH:MM or H:MM (24h) string or an already-12h string to 12-hour format with AM/PM
        function to12Hour(timeStr) {
            if (!timeStr) return timeStr;
            const s = timeStr.trim();
            if (/[AP]M$/i.test(s)) return s; // already 12-hour

            const m = s.match(/(\d{1,2}):(\d{2})/);
            if (!m) return timeStr;

            let h = parseInt(m[1], 10);
            const min = m[2];

            const period = h >= 12 ? 'PM' : 'AM';
            h = h % 12;
            if (h === 0) h = 12;

            return `${h}:${min} ${period}`;
        }

        async function fetchPrayerTimes() {
            try {
                const today = new Date();
                const date = `${today.getDate().toString().padStart(2, '0')}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getFullYear()}`;
                
                const response = await fetch(`https://api.aladhan.com/v1/timings/${date}?latitude=25.2854&longitude=51.5310&method=10&tune=0,-1,-1,1,1,2,0,2,-1&format=12h`);
                const data = await response.json();
                
                prayerTimes = data.data.timings;
                
                // Update Hijri date
                const hijri = data.data.date.hijri;
                document.getElementById('hijri-date').textContent = `${hijri.day} ${hijri.month.en} ${hijri.year}`;
                
                // Update Gregorian date
                const gregorian = data.data.date.gregorian;
                document.getElementById('gregorian-date').textContent = `${gregorian.day} ${gregorian.month.en} ${gregorian.year}`;
                
                renderPrayerCards();
                updateNextPrayer();
            } catch (error) {
                console.error('Error fetching prayer times:', error);
                document.getElementById('prayer-grid').innerHTML = '<p style="color: white; text-align: center; grid-column: 1/-1;">Error loading prayer times. Please try again later.</p>';
            }
        }

        function renderPrayerCards() {
            const grid = document.getElementById('prayer-grid');
            grid.innerHTML = '';
            
            prayers.forEach(prayer => {
                const timeRaw = prayerTimes[prayer.key] || '--:--';
                const time = to12Hour(timeRaw);
                const offset = iqamaOffsets[prayer.key] || 0;
                const iqamaTime = (offset > 0 && prayerTimes[prayer.key]) ? to12Hour(calculateIqama(prayerTimes[prayer.key], offset)) : '—';
                const card = document.createElement('div');
                card.className = `prayer-card ${prayer.id}`;
                card.id = `card-${prayer.id}`;
                card.innerHTML = `
                    <div class="icon"><i class="fas ${iconMap[prayer.id]}"></i></div>
                    <div class="name">${prayer.name}</div>
                    <div class="arabic">${prayer.arabic}</div>
                    <div class="time">${time}</div>
                    <div class="iqama">Iqama: ${iqamaTime}</div>
                `;
                grid.appendChild(card);
            });
        }

        function updateNextPrayer() {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            
            // Calculate next prayer (excluding Sunrise, Sunset, Midnight from the main prayer cycle)
            const prayerOrder = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            
            let nextPrayer = null;
            let nextPrayerTime = null;
            let minDiff = Infinity;
            
            for (const prayerKey of prayerOrder) {
                const time = prayerTimes[prayerKey];
                if (!time) continue;

                let prayerMinutes = timeToMinutes(time);
                let diff = prayerMinutes - currentMinutes;
                if (diff < 0) diff += 24 * 60;

                if (diff < minDiff) {
                    minDiff = diff;
                    nextPrayer = prayerKey;
                    nextPrayerTime = time;
                }
            }
            
            // Update next prayer display
            const prayerInfo = prayers.find(p => p.key === nextPrayer);
                if (prayerInfo) {
                document.getElementById('next-prayer-name').textContent = `${prayerInfo.name} - ${to12Hour(nextPrayerTime)}`;
                
                const hours = Math.floor(minDiff / 60);
                const mins = minDiff % 60;
                document.getElementById('countdown').textContent = `in ${hours}h ${mins}m`;
                
                // Highlight active card
                document.querySelectorAll('.prayer-card').forEach(card => card.classList.remove('active'));
                const activeCard = document.getElementById(`card-${prayerInfo.id}`);
                if (activeCard) activeCard.classList.add('active');
            }
        }

        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            document.getElementById('current-time').textContent = timeStr;
        }

        // Initialize
        fetchPrayerTimes();
        updateClock();
        
        // Update clock every second
        setInterval(updateClock, 1000);
        
        // Update next prayer every minute
        setInterval(updateNextPrayer, 60000);
        
        // Refresh prayer times at midnight
        setInterval(() => {
            const now = new Date();
            if (now.getHours() === 0 && now.getMinutes() === 0) {
                fetchPrayerTimes();
            }
        }, 60000);
    </script>
</body>

</html>
